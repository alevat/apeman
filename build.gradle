buildscript {
    repositories {
        jcenter()
        maven {
            url "https://plugins.gradle.org/m2/"
        }
    }

    dependencies {
        classpath 'org.springframework.boot:spring-boot-gradle-plugin:1.5.2.RELEASE'
        classpath 'org.asciidoctor:asciidoctor-gradle-plugin:1.5.3'
        classpath "com.moowork.gradle:gradle-node-plugin:1.1.1"
    }
}

apply plugin: 'java'
apply plugin: 'war'
apply plugin: 'org.springframework.boot'
apply plugin: "com.moowork.node"
apply plugin: 'org.asciidoctor.convert'

sourceCompatibility = 1.8
targetCompatibility = 1.8

repositories {
    jcenter()
}

dependencies {
    compile 'org.springframework.boot:spring-boot-starter-web'

    testCompile 'junit:junit:4.12'
}

task webpack(type: NodeTask) {
    dependsOn npmInstall
    script = file("${project.projectDir}/node_modules/.bin/webpack")
    args = ["--config", "webpack/webpack.build.js"]
}

asciidoctor {
    sourceDir = file('docs')
    sources {
        include '/**/*.adoc'
    }
    outputDir = file('build/docs')
}
processResources.dependsOn 'webpack'

webAppDirName = 'build/webapp'
